
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Week 11 Student Notes</title>
<script src="https://cdn.tailwindcss.com?plugins=typography"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<script>
 tailwind.config = {
 darkMode: 'class',
 theme: {
 extend: {
 fontFamily: {
 sans: ['Inter', 'sans-serif'],
 },
 colors: {
 primary: '#002F6E', // VUT Midnight Blue
 secondary: '#6c757d',
 codebg: 'var(--bg-code)', 
 },
 typography: {
 DEFAULT: {
 css: {
 maxWidth: '100%',
 fontFamily: 'Inter, sans-serif',
 color: 'var(--text-body)',
 '--tw-prose-body': 'var(--text-body)',
 '--tw-prose-headings': 'var(--text-headings)',
 '--tw-prose-links': 'var(--text-link)',
 '--tw-prose-bold': 'var(--text-headings)',
 '--tw-prose-counters': 'var(--text-body)',
 '--tw-prose-bullets': 'var(--text-body)',
 '--tw-prose-hr': 'var(--border-color)',
 '--tw-prose-quotes': 'var(--text-body)',
 '--tw-prose-code': 'var(--text-code)',
 '--tw-prose-pre-code': 'var(--text-pre)',
 '--tw-prose-pre-bg': 'var(--bg-pre)',
 
 // Image Sizing Control
 img: {
 display: 'block',
 marginLeft: 'auto',
 marginRight: 'auto',
 maxHeight: '500px',
 width: 'auto',
 height: 'auto',
 borderRadius: '0.5rem',
 boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
 },
 // Links
 a: {
 color: 'var(--text-link)',
 '&:hover': { opacity: '0.8' },
 },
 // Inline Code
 code: {
 color: 'var(--text-code)',
 backgroundColor: 'var(--bg-code)',
 padding: '0.2rem 0.4rem',
 borderRadius: '0.25rem',
 fontWeight: '600',
 border: '1px solid var(--border-code)',
 },
 'code::before': { content: '' },
 'code::after': { content: '' },
 // Code Blocks (Pre)
 pre: {
 backgroundColor: 'var(--bg-pre) !important',
 color: 'var(--text-pre)',
 padding: '1rem',
 borderRadius: '0.5rem',
 border: '1px solid var(--border-pre)',
 },
 // Notes/Alerts (Blockquotes)
 blockquote: {
 borderLeftColor: '#002F6E',
 borderLeftWidth: '4px',
 backgroundColor: 'var(--bg-note)',
 padding: '1rem',
 color: 'var(--text-body)',
 fontSize: '0.9rem', // Smaller text for notes
 fontStyle: 'italic',
 quotes: 'none',
 borderRadius: '0 0.5rem 0.5rem 0',
 },
 'blockquote p:first-of-type::before': { content: 'none' },
 'blockquote p:last-of-type::after': { content: 'none' },
 // Tables (Restored from First Attempt)
 table: {
 width: '100%',
 marginTop: '2em',
 marginBottom: '2em',
 borderCollapse: 'collapse',
 fontSize: '0.9rem',
 },
 'thead th': {
 backgroundColor: '#f3f4f6', 
 color: '#1f2937', 
 fontWeight: '600',
 padding: '0.75rem',
 borderBottom: '2px solid #e5e7eb',
 textAlign: 'left',
 },
 'tbody td': {
 padding: '0.75rem',
 borderBottom: '1px solid #e5e7eb',
 verticalAlign: 'top',
 },
 'tbody tr:hover': {
 backgroundColor: '#f9fafb',
 },
 
 // Task Lists (Checkboxes)
 '.task-list-item': {
 listStyleType: 'none',
 },
 '.task-list-item input[type="checkbox"]': {
 marginRight: '0.5rem',
 },

 thead: {
 borderBottomWidth: '2px',
 borderBottomColor: 'var(--border-color)',
 },
 'thead th': {
 color: 'var(--text-headings)',
 fontWeight: '600',
 verticalAlign: 'bottom',
 paddingRight: '0.75em',
 paddingBottom: '0.75em',
 paddingLeft: '0.75em',
 textAlign: 'left',
 },
 'tbody tr': {
 borderBottomWidth: '1px',
 borderBottomColor: 'var(--border-color)',
 },
 'tbody tr:last-child': {
 borderBottomWidth: '0',
 },
 'tbody td': {
 verticalAlign: 'top',
 padding: '0.75em',
 },
 },
 },
 },
 },
 },
 }
</script>
<script>
 // Theme Toggle Logic
 document.addEventListener('DOMContentLoaded', () => {
 const themeToggle = document.getElementById('theme-toggle');
 const html = document.documentElement;
 const iconSun = document.getElementById('icon-sun');
 const iconMoon = document.getElementById('icon-moon');

 // Check local storage or preference
 if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
 html.classList.add('dark');
 iconSun.classList.remove('hidden');
 iconMoon.classList.add('hidden');
 } else {
 html.classList.remove('dark');
 iconSun.classList.add('hidden');
 iconMoon.classList.remove('hidden');
 }

 themeToggle.addEventListener('click', () => {
 if (html.classList.contains('dark')) {
 html.classList.remove('dark');
 localStorage.theme = 'light';
 iconSun.classList.add('hidden');
 iconMoon.classList.remove('hidden');
 } else {
 html.classList.add('dark');
 localStorage.theme = 'dark';
 iconSun.classList.remove('hidden');
 iconMoon.classList.add('hidden');
 }
 });
 });
</script>
<style>
 /* CSS Variables for Theming */
 :root {
 --bg-body: #f8fafc;
 --bg-card: #ffffff;
 --text-body: #334155;
 --text-headings: #0f172a;
 --text-link: #002F6E; /* VUT Blue */
 --border-color: #e2e8f0;
 
 /* Code - Light Mode */
 --bg-code: #f1f5f9;
 --text-code: #d63384;
 --border-code: #e2e8f0;
 
 /* Pre - Light Mode (Github Light) */
 --bg-pre: #f6f8fa;
 --text-pre: #24292e;
 --border-pre: #d0d7de;
 
 /* Note - Light Mode */
 --bg-note: #f8f9fa;
 
 /* Scrollbar */
 --scroll-track: #f1f1f1;
 --scroll-thumb: #888;
 }

 html.dark {
 --bg-body: #0f172a;
 --bg-card: #1e293b;
 --text-body: #cbd5e1;
 --text-headings: #f8fafc;
 --text-link: #60a5fa; /* Blue 400 - Brighter for better contrast */
 --border-color: #334155;
 
 /* Code - Dark Mode */
 --bg-code: #334155;
 --text-code: #f472b6; 
 --border-code: #475569;
 
 /* Pre - Dark Mode (Monokai) */
 --bg-pre: #272822;
 --text-pre: #f8f8f2;
 --border-pre: #464539;
 
 /* Note - Dark Mode */
 --bg-note: #1e293b;
 --scroll-track: #1e293b;
 --scroll-thumb: #475569;
 }

 /* Transition */
 body, article, code, pre, blockquote {
 transition: background-color 0.3s, color 0.3s, border-color 0.3s;
 }

 /* Custom Scrollbar */
 ::-webkit-scrollbar { width: 8px; height: 8px; }
 ::-webkit-scrollbar-track { background: var(--scroll-track); }
 ::-webkit-scrollbar-thumb { background: var(--scroll-thumb); border-radius: 4px; }
 ::-webkit-scrollbar-thumb:hover { background: #555; }
 
 /* Syntax Highlighting - LIGHT MODE (GitHub Light Inspired) */
 .codehilite .hll { background-color: #ffffcc }
 .codehilite .c { color: #6a737d; font-style: italic } /* Comment */
 .codehilite .err { color: #f05240; background-color: #ffeaea } /* Error */
 .codehilite .k { color: #d73a49; font-weight: bold } /* Keyword */
 .codehilite .o { color: #d73a49; font-weight: bold } /* Operator */
 .codehilite .cm { color: #6a737d; font-style: italic } /* Comment.Multiline */
 .codehilite .cp { color: #6a737d; font-weight: bold } /* Comment.Preproc */
 .codehilite .c1 { color: #6a737d; font-style: italic } /* Comment.Single */
 .codehilite .cs { color: #6a737d; font-style: italic } /* Comment.Special */
 .codehilite .gd { color: #d73a49; background-color: #fdd } /* Generic.Deleted */
 .codehilite .ge { font-style: italic } /* Generic.Emph */
 .codehilite .gr { color: #aa0000 } /* Generic.Error */
 .codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
 .codehilite .gi { color: #00a000; background-color: #dfd } /* Generic.Inserted */
 .codehilite .go { color: #888888 } /* Generic.Output */
 .codehilite .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
 .codehilite .gs { font-weight: bold } /* Generic.Strong */
 .codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
 .codehilite .gt { color: #aa0000 } /* Generic.Traceback */
 .codehilite .kc { color: #005cc5; font-weight: bold } /* Keyword.Constant */
 .codehilite .kd { color: #d73a49; font-weight: bold } /* Keyword.Declaration */
 .codehilite .kn { color: #d73a49; font-weight: bold } /* Keyword.Namespace */
 .codehilite .kp { color: #d73a49 } /* Keyword.Pseudo */
 .codehilite .kr { color: #d73a49; font-weight: bold } /* Keyword.Reserved */
 .codehilite .kt { color: #445588; font-weight: bold } /* Keyword.Type */
 .codehilite .m { color: #005cc5 } /* Literal.Number */
 .codehilite .s { color: #032f62 } /* Literal.String */
 .codehilite .na { color: #22863a } /* Name.Attribute */
 .codehilite .nb { color: #005cc5 } /* Name.Builtin */
 .codehilite .nc { color: #6f42c1; font-weight: bold } /* Name.Class */
 .codehilite .no { color: #005cc5 } /* Name.Constant */
 .codehilite .nd { color: #6f42c1; font-weight: bold } /* Name.Decorator */
 .codehilite .ni { color: #800080 } /* Name.Entity */
 .codehilite .ne { color: #990000; font-weight: bold } /* Name.Exception */
 .codehilite .nf { color: #6f42c1; font-weight: bold } /* Name.Function */
 .codehilite .nl { color: #990000; font-weight: bold } /* Name.Label */
 .codehilite .nn { color: #6f42c1; font-weight: bold } /* Name.Namespace */
 .codehilite .nt { color: #22863a } /* Name.Tag */
 .codehilite .nv { color: #e36209 } /* Name.Variable */
 .codehilite .ow { color: #d73a49; font-weight: bold } /* Operator.Word */
 .codehilite .w { color: #bbbbbb } /* Text.Whitespace */
 .codehilite .mf { color: #005cc5 } /* Literal.Number.Float */
 .codehilite .mh { color: #005cc5 } /* Literal.Number.Hex */
 .codehilite .mi { color: #005cc5 } /* Literal.Number.Integer */
 .codehilite .mo { color: #005cc5 } /* Literal.Number.Oct */
 .codehilite .sb { color: #032f62 } /* Literal.String.Backtick */
 .codehilite .sc { color: #032f62 } /* Literal.String.Char */
 .codehilite .sd { color: #032f62 } /* Literal.String.Doc */
 .codehilite .s2 { color: #032f62 } /* Literal.String.Double */
 .codehilite .se { color: #005cc5 } /* Literal.String.Escape */
 .codehilite .sh { color: #032f62 } /* Literal.String.Heredoc */
 .codehilite .si { color: #032f62 } /* Literal.String.Interpol */
 .codehilite .sx { color: #032f62 } /* Literal.String.Other */
 .codehilite .sr { color: #032f62 } /* Literal.String.Regex */
 .codehilite .s1 { color: #032f62 } /* Literal.String.Single */
 .codehilite .ss { color: #005cc5 } /* Literal.String.Symbol */
 .codehilite .bp { color: #005cc5 } /* Name.Builtin.Pseudo */
 .codehilite .vc { color: #e36209 } /* Name.Variable.Class */
 .codehilite .vg { color: #e36209 } /* Name.Variable.Global */
 .codehilite .vi { color: #e36209 } /* Name.Variable.Instance */
 .codehilite .il { color: #005cc5 } /* Literal.Number.Integer.Long */
 
 /* Syntax Highlighting - DARK MODE (Monokai Overrides) */
 html.dark .codehilite .hll { background-color: #49483e }
 html.dark .codehilite .c { color: #75715e } /* Comment */
 html.dark .codehilite .err { color: #960050; background-color: #1e0010 } /* Error */
 html.dark .codehilite .k { color: #66d9ef; font-weight: normal } /* Keyword */
 html.dark .codehilite .l { color: #ae81ff } /* Literal */
 html.dark .codehilite .n { color: #f8f8f2 } /* Name */
 html.dark .codehilite .o { color: #f92672; font-weight: normal } /* Operator */
 html.dark .codehilite .p { color: #f8f8f2 } /* Punctuation */
 html.dark .codehilite .cm { color: #75715e } /* Comment.Multiline */
 html.dark .codehilite .cp { color: #75715e } /* Comment.Preproc */
 html.dark .codehilite .c1 { color: #75715e } /* Comment.Single */
 html.dark .codehilite .cs { color: #75715e } /* Comment.Special */
 html.dark .codehilite .ge { font-style: italic } /* Generic.Emph */
 html.dark .codehilite .gs { font-weight: bold } /* Generic.Strong */
 html.dark .codehilite .kc { color: #66d9ef; font-weight: normal } /* Keyword.Constant */
 html.dark .codehilite .kd { color: #66d9ef; font-weight: normal } /* Keyword.Declaration */
 html.dark .codehilite .kn { color: #f92672; font-weight: normal } /* Keyword.Namespace */
 html.dark .codehilite .kp { color: #66d9ef; font-weight: normal } /* Keyword.Pseudo */
 html.dark .codehilite .kr { color: #66d9ef; font-weight: normal } /* Keyword.Reserved */
 html.dark .codehilite .kt { color: #66d9ef; font-weight: normal } /* Keyword.Type */
 html.dark .codehilite .ld { color: #e6db74 } /* Literal.Date */
 html.dark .codehilite .m { color: #ae81ff } /* Literal.Number */
 html.dark .codehilite .s { color: #e6db74 } /* Literal.String */
 html.dark .codehilite .na { color: #a6e22e } /* Name.Attribute */
 html.dark .codehilite .nb { color: #f8f8f2 } /* Name.Builtin */
 html.dark .codehilite .nc { color: #a6e22e } /* Name.Class */
 html.dark .codehilite .no { color: #66d9ef } /* Name.Constant */
 html.dark .codehilite .nd { color: #a6e22e } /* Name.Decorator */
 html.dark .codehilite .ni { color: #f8f8f2 } /* Name.Entity */
 html.dark .codehilite .ne { color: #a6e22e } /* Name.Exception */
 html.dark .codehilite .nf { color: #a6e22e } /* Name.Function */
 html.dark .codehilite .nl { color: #f8f8f2 } /* Name.Label */
 html.dark .codehilite .nn { color: #f8f8f2 } /* Name.Namespace */
 html.dark .codehilite .nx { color: #a6e22e } /* Name.Other */
 html.dark .codehilite .py { color: #f8f8f2 } /* Name.Property */
 html.dark .codehilite .nt { color: #f92672 } /* Name.Tag */
 html.dark .codehilite .nv { color: #f8f8f2 } /* Name.Variable */
 html.dark .codehilite .ow { color: #f92672; font-weight: normal } /* Operator.Word */
 html.dark .codehilite .w { color: #f8f8f2 } /* Text.Whitespace */
 html.dark .codehilite .mb { color: #ae81ff } /* Literal.Number.Bin */
 html.dark .codehilite .mf { color: #ae81ff } /* Literal.Number.Float */
 html.dark .codehilite .mh { color: #ae81ff } /* Literal.Number.Hex */
 html.dark .codehilite .mi { color: #ae81ff } /* Literal.Number.Integer */
 html.dark .codehilite .mo { color: #ae81ff } /* Literal.Number.Oct */
 html.dark .codehilite .sb { color: #e6db74 } /* Literal.String.Backtick */
 html.dark .codehilite .sc { color: #e6db74 } /* Literal.String.Char */
 html.dark .codehilite .sd { color: #e6db74 } /* Literal.String.Doc */
 html.dark .codehilite .s2 { color: #e6db74 } /* Literal.String.Double */
 html.dark .codehilite .se { color: #ae81ff } /* Literal.String.Escape */
 html.dark .codehilite .sh { color: #e6db74 } /* Literal.String.Heredoc */
 html.dark .codehilite .si { color: #e6db74 } /* Literal.String.Interpol */
 html.dark .codehilite .sx { color: #e6db74 } /* Literal.String.Other */
 html.dark .codehilite .sr { color: #e6db74 } /* Literal.String.Regex */
 html.dark .codehilite .s1 { color: #e6db74 } /* Literal.String.Single */
 html.dark .codehilite .ss { color: #ae81ff } /* Literal.String.Symbol */
</style>
<style>
        /* Glossary Tooltip Styles */
        .glossary-term {
            color: #c9984a;
            border-bottom: 2px dotted #c9984a;
            cursor: help;
            position: relative;
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .glossary-term:hover {
            color: #ffffff;
            border-bottom-color: #ffffff;
        }
        
        .glossary-tooltip {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            z-index: 1000;
            background: linear-gradient(135deg, #1e3a5f 0%, #142a46 100%);
            color: #ffffff;
            padding: 12px 16px;
            border-radius: 8px;
            border: 2px solid #c9984a;
            font-size: 14px;
            line-height: 1.5;
            max-width: 300px;
            width: max-content;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            transition: opacity 0.3s, visibility 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .glossary-tooltip::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -8px;
            border-width: 8px;
            border-style: solid;
            border-color: #c9984a transparent transparent transparent;
        }
        
        .glossary-term:hover .glossary-tooltip {
            visibility: visible;
            opacity: 1;
        }
        </style></head>
<body class="bg-[var(--bg-body)] text-[var(--text-body)] pt-20 transition-colors duration-300">
<!-- Navigation -->
<nav class="fixed top-0 left-0 right-0 bg-[var(--bg-card)]/90 backdrop-blur-md shadow-sm z-50 border-b border-[var(--border-color)] transition-colors duration-300">
<div class="container mx-auto px-4 max-w-5xl h-16 flex items-center justify-between">
<a class="flex items-center space-x-3 text-[var(--text-headings)] hover:text-blue-600 transition-colors no-underline" href="../index.html">
<img alt="VUT Logo" class="h-12 w-auto object-contain" src="../ops3_logo.png"/>
<div class="flex flex-col">
<span class="font-bold text-lg leading-tight tracking-tight text-primary dark:text-sky-400 hidden sm:block">Operating Systems 3
<span class="text-xs text-slate-500 dark:text-slate-400 font-medium hidden sm:block">Virtualisation &amp; Cloud Technologies
<span class="font-bold text-lg tracking-tight sm:hidden">OPS3
</span></span></span></div>
<div class="flex items-center space-x-6">
<a class="text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-blue-600 dark:hover:text-sky-400 transition-colors no-underline" href="../index.html">
 Course Home
 
<!-- Theme Toggle Button -->
<button class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors" id="theme-toggle">
<!-- Sun Icon -->
<svg class="w-5 h-5 text-yellow-500 hidden" fill="none" id="icon-sun" stroke="currentColor" viewbox="0 0 24 24"><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
<!-- Moon Icon -->
<svg class="w-5 h-5 text-slate-500" fill="none" id="icon-moon" stroke="currentColor" viewbox="0 0 24 24"><path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
</button>
</a></div>
</a></div>
</nav>
<!-- Main Content -->
<main class="container mx-auto px-4 max-w-5xl mb-12">
<article class="prose lg:prose-lg max-w-none bg-[var(--bg-card)] p-6 md:p-12 rounded-xl shadow-sm border border-[var(--border-color)] transition-colors duration-300">
<p><a href="../index.html">← Back to Course Index</a></p>
<div class="flex items-stretch bg-gray-50 dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm mb-8 overflow-hidden">
<div class="w-40 flex-shrink-0 flex items-center justify-center bg-white dark:bg-gray-900">
<img alt="Automation Icon" class="h-full w-full object-cover" src="images/week_11_icon.png"/>
</div>
<div class="flex-1 flex flex-col items-center justify-center p-6">
<h1 class="text-2xl font-bold text-primary dark:text-sky-400 m-0 text-center">Automation and Cloud API</h1>
<span class="text-lg font-medium text-gray-500 dark:text-gray-400 mt-1">Student Notes
</span></div>
</div>
<p><strong>Course</strong>: Computer Systems Engineering
<strong>Module</strong>: Operating Systems 3 (Virtualisation &amp; Cloud Technologies)
<strong>Topic</strong>: Automation and Cloud <a class="glossary-term" href="glossary.html#API">API<span class="glossary-tooltip">Application Programming Interface</span></a>
<strong>Estimated Reading Time</strong>: 30 Minutes</p>
<blockquote>
<p>[!TIP]
<strong>How to succeed in this week</strong>:
Automation is what separates a cloud engineer from a sysadmin. Focus on understanding APIs and —clicking buttons doesn't scale, but code does.</p>
</blockquote>
<hr/>
<h2 id="welcome-to-devops">Welcome to DevOps</h2>
<p>Clicking GUI buttons is fine for 1 server. It fails for 100 servers. This creates a scalability bottleneck that manual administration simply cannot overcome.</p>
<p>This challenge gave birth to <strong>DevOps</strong>, a methodology that unifies software development (Dev) and IT operations (Ops). At its core, DevOps is about automation, collaboration, and speed. It shifts the focus from manually configuring servers to writing code that defines them—a concept known as <strong> (<a class="glossary-term" href="glossary.html#IaC">IaC<span class="glossary-tooltip">Infrastructure as Code</span></a> )</strong>. In a DevOps model, infrastructure is versioned, tested, and deployed just like software applications, eliminating the "it works on my machine" problem.</p>
<p>This week, we learn to control the cloud using code. By mastering tools like the <a class="glossary-term" href="glossary.html#OpenStack">OpenStack<span class="glossary-tooltip">Open-source cloud computing platform</span></a> platform <a class="glossary-term" href="glossary.html#CLI">CLI<span class="glossary-tooltip">Command Line Interface</span></a>, Cloud-Init, Heat, and <a class="glossary-term" href="glossary.html#Ansible">Ansible<span class="glossary-tooltip">Automation tool for configuration management</span></a>, you are learning the foundational skills required for a modern DevOps or Site Reliability Engineering (SRE) role. You will transition from clicking buttons in a dashboard to designing self-healing, automated systems that can scale to thousands of instances with a single command.</p>
<hr/>
<h2 id="1-advanced-cli-techniques">1. Advanced CLI Techniques</h2>
<p>The <code>openstack</code> command is powerful, but by default, it formats output as ASCII tables designed for human readability. While this is helpful for interactive use, it poses a significant challenge for automation scripts, which struggle to parse table borders and varying whitespace. To build robust tools, we must use machine-readable output formats.</p>
<h3 id="11-formatting-output">1.1 Formatting Output</h3>
<p>The CLI natively supports JSON output, which provides a structured and predictable data format that scripting languages can easily parse. By appending <code>--format json</code> to any command, we strip away the visual formatting and receive raw data objects.</p>
<div class="codehilite"><pre><span><code><span class="c1"># Standard Table (Human Readable)
openstack<span class="w"> server<span class="w"> list

<span class="c1"># JSON Output (Machine Readable)
openstack<span class="w"> server<span class="w"> list<span class="w"> --format<span class="w"> json
</span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Command Analysis</strong>:
* <code>--format json</code>: Forces the CLI to output raw JSON data instead of an ASCII table. This is essential for piping data into tools like <code>jq</code> or Python scripts.</p>
</blockquote>
<h3 id="12-parsing-with-jq">1.2 Parsing with <code>jq</code></h3>
<p><code>jq</code> is a lightweight command-line JSON processor that allows us to filter, slice, and map JSON data directly in the terminal. It acts as a bridge between the verbose API output and the specific strings (like UUIDs) needed for subsequent commands.</p>
<div class="codehilite"><pre><span><code><span class="c1"># Basic: Get the ID of the network named 'private-net'
<span class="nv">NET_ID<span class="o">=<span class="k">$(openstack<span class="w"> network<span class="w"> show<span class="w"> private-net<span class="w"> -f<span class="w"> json<span class="w"> <span class="p">|<span class="w"> jq<span class="w"> -r<span class="w"> .id<span class="k">)
<span class="nb">echo<span class="w"> <span class="nv">$NET_ID

<span class="c1"># We pipe the server list into jq, filter for specific status, and extract the IDs.
<span class="nv">ACTIVE_IDS<span class="o">=<span class="k">$(openstack<span class="w"> server<span class="w"> list<span class="w"> -f<span class="w"> json<span class="w"> <span class="p">|<span class="w"> jq<span class="w"> -r<span class="w"> <span class="s1">'.[] | select(.Status=="ACTIVE") | .ID'<span class="k">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Code Analysis</strong>:
* <code>$()</code>: Command substitution; runs the inner command and assigns the output to the variable.
* <code>|</code>: The pipe operator passes the output of the openstack platform command directly to <code>jq</code>.
* <code>jq -r .id</code>: Filters the JSON to find the key "id". The <code>-r</code> (raw) flag removes quotation marks, leaving just the UUID.
* <code>select()</code>: A powerful <code>jq</code> function that acts like a <code>WHERE</code> clause in SQL, allowing you to filter lists based on conditions.
In the example above, the <code>-f json</code> flag forces OpenStack platform to output JSON. We then pipe this valid JSON to <code>jq</code>. The <code>-r</code> flag is crucial as it outputs "raw" strings without quotation marks, making the output ready for variable assignment. We also use the <code>select</code> function to filter the array, ignoring any servers that are building, paused, or shut down.</p>
</blockquote>
<h3 id="13-architectural-insight-golden-images-vs-post-boot-config">1.3 Architectural Insight: Golden Images vs. Post-Boot Config</h3>
<p>The <em>OpenStack platform for Architects</em> book details two competing strategies for deploying applications: <strong>Golden Images</strong> and <strong>Post-Boot Configuration</strong>.</p>
<p><img alt="Pet vs Cattle Automation" src="images/pet_vs_cattle_automation.png"/>
<em>Figure 1: Pet vs Cattle - Manual "Pet" servers require constant care, while Automated "Cattle" servers are replaceable and identical</em></p>
<p><strong>Golden Images (Mutable/Baked)</strong> involve installing all application dependencies—such as Apache, PHP, and custom code—into the Virtual Machine image <em>before</em> it is ever launched. This is typically done using tools like Packer. The primary advantage is speed; since the software is pre-installed, the VM - is ready almost instantly upon boot. However, this method suffers from "Image Sprawl," where every minor code change requires building and uploading a new multi-gigabyte image to Glance platform image service , consuming storage and bandwidth.</p>
<p><strong>Post-Boot Configuration (Immutable/Runtime)</strong> takes a different approach. You launch a generic, "Vanilla" operating system image (like Ubuntu Cloud Image) and use automation tools to install software <em>after</em> the instance boots. While this results in a slower initial startup time as packages are downloaded and installed, it offers superior flexibility. A single small base image can serve thousands of different purposes. Modern cloud architecture typically favors a <strong>Hybrid Approach</strong>, using a base image for the OS and tools like Ansible for the final application configuration.</p>
<h3 id="section-1-checkpoint">Section 1 Checkpoint</h3>
<p><strong>Summary</strong>: JSON is the lingua franca of Cloud APIs, providing a structured format that is difficult for humans to read but trivial for machines to parse. To work effectively with this data in a shell environment, <code>jq</code> is an essential tool for extracting specific fields like resource IDs. Before writing any automation script, a cloud engineer must master the ability to retrieve clean, predictable data programmatically rather than relying on brittle text parsing methods like <code>grep</code>.</p>
<p><strong>Reflection</strong>: Consider why <code>grep</code> is a poor choice for parsing JSON data; a simple change in line breaks or spacing could break a script, whereas <code>jq</code> parses the data structure itself. Also, recall that the <code>-r</code> flag in <code>jq</code> strips quotes from the output, which is essentially when passing values to other CLI commands.</p>
<p><strong>Resources</strong>:
<a href="https://stedolan.github.io/jq/tutorial/">jq Tutorial</a></p>
<hr/>
<h2 id="2-cloud-init-the-standard-for-bootstrapping">2. Cloud-Init: The Standard for Bootstrapping</h2>
<p>When a virtual machine boots in the cloud, it starts as a generic "clone " of an Operating System. It has no idea who it is, what its hostname should be, or what software it needs. <strong>Cloud-Init</strong> is the industry-standard multi-distribution package that solves this identity crisis. It runs during the initial boot process to identify the environment and apply unique configurations.</p>
<p><img alt="Cloud-Init Boot Stages" src="images/cloud_init_boot_stages.png"/>
<em>Figure 2: Cloud-Init Workflow - How the script is injected from the Metadata Service and executed during the first boot</em></p>
<h3 id="21-how-it-works-the-datasource">2.1 How it Works: The Datasource</h3>
<p>The magic of Cloud-Init relies on a <strong>Datasource</strong>. On boot, Cloud-Init acts like a detective, probing the network to find out where it is running. In OpenStack platform (and AWS), it typically queries the <strong>Metadata Service</strong> at the "Magic IP" <code>169.254.169.254</code>. If it receives a response, it pulls down a JSON payload containing the instance's Hostname, SSH Keys, and the <strong>User Data</strong> provided by the operator.</p>
<h3 id="22-execution-stages">2.2 Execution Stages</h3>
<p>Cloud-Init does not run as a single script; it executes in distinct stages throughout the boot process to ensure dependencies are met:
1. <strong>Generator</strong>: Determines if cloud-init should run at all.
2. <strong>Local (Init)</strong>: Finds the datasource and applies networking. This is critical because without networking, it cannot fetch further data.
3. <strong>Network (Config)</strong>: Runs after networking is up. Disk formatting, mount points, and SSH key injection happen here.
4. <strong>Final</strong>: This is where <strong>User Data</strong> scripts run (installing packages, running commands). This ensures the system is fully online before attempting to install software.</p>
<h3 id="23-the-cloud-config-format">2.3 The Cloud-Config Format</h3>
<p>While User Data can be a simple Bash script, the preferred format is <strong>Cloud-Config</strong>. This is a declarative YAML syntax that abstractly defines <em>what</em> you want, rather than <em>how</em> to do it. To use this format, the input string must begin with the <code>#cloud-config</code> directive.</p>
<div class="codehilite"><pre><span><code><span class="c1">#cloud-config
<span class="nt">hostname<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">web-01
<span class="nt">packages<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="l l-Scalar l-Scalar-Plain">apache2
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="l l-Scalar l-Scalar-Plain">htop
<span class="nt">runcmd<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="l l-Scalar l-Scalar-Plain">systemctl start apache2
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="l l-Scalar l-Scalar-Plain">echo "&lt;h1&gt;Deployed via Automation&lt;/h1&gt;" &gt; /var/www/html/index.html
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Config Analysis</strong>:
* <code>#cloud-config</code>: The required header telling Cloud-Init this is declarative YAML.
* <code>packages</code>: A list of software to install via the OS package manager (<code>apt</code>, <code>yum</code>).
* <code>runcmd</code>: A list of shell commands to execute <em>after</em> packages are installed. This is often used to start services or configure files.</p>
</blockquote>
<h3 id="24-common-patterns-the-cookbook">2.4 Common Patterns (The Cookbook)</h3>
<p>Writing User Data requires understanding common patterns. Below are standard recipes frequently used in production.</p>
<p><strong>Pattern 1: The Web Server</strong>
This pattern installs a web server, writes a custom index file, and ensures the service is running.</p>
<div class="codehilite"><pre><span><code><span class="c1">#cloud-config
<span class="nt">packages<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="l l-Scalar l-Scalar-Plain">nginx
<span class="nt">write_files<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">content<span class="p">:<span class="w"> <span class="p p-Indicator">|
<span class="w"> <span class="no">&lt;h1&gt;Welcome to Cloud&lt;/h1&gt;
<span class="w"> <span class="nt">path<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">/var/www/html/index.html
<span class="nt">runcmd<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="l l-Scalar l-Scalar-Plain">systemctl restart nginx
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Pattern Analysis</strong>:
* <code>write_files</code>: Creates use-case specific configuration files. The <code>content</code> block allows multiline text.
* <code>runcmd</code>: Restarts the service to ensure the new configuration is applied.</p>
</blockquote>
<p><strong>Pattern 2: The User Creator</strong>
This pattern creates a new user account, grants it sudo privileges without a password requirement, and injects an SSH public key for secure access.</p>
<div class="codehilite"><pre><span><code><span class="c1">#cloud-config
<span class="nt">users<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">student
<span class="w"> <span class="nt">groups<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">sudo
<span class="w"> <span class="nt">shell<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">/bin/bash
<span class="w"> <span class="nt">sudo<span class="p">:<span class="w"> <span class="p p-Indicator">[<span class="s">'ALL=(ALL)<span class="nv"> <span class="s">NOPASSWD:ALL'<span class="p p-Indicator">]
<span class="w"> <span class="nt">ssh_authorized_keys<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="l l-Scalar l-Scalar-Plain">ssh-rsa AAAAB3Nza...
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Pattern Analysis</strong>:
* <code>users</code>: A dedicated module for user management.
* <code>sudo</code>: Grants password-less root access, critical for automated management tools like Ansible.</p>
</blockquote>
<p><strong>Pattern 3: The Update</strong>
This pattern instructs the system to upgrade all installed packages on boot. Use this cautiously, as it significantly increases the boot time.</p>
<div class="codehilite"><pre><span><code><span class="c1">#cloud-config
<span class="nt">package_upgrade<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">true
</span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Pattern Analysis</strong>:
* <code>package_upgrade: true</code>: Forces an <code>apt-get upgrade</code> or <code>yum update</code> on first boot. While secure, it adds significant time to the boot process.</p>
</blockquote>
<h3 id="25-using-it-in-cli">2.5 Using it in CLI</h3>
<p>To inject this configuration, you save the YAML to a local file (e.g., <code>setup.yaml</code>) and pass it to the compute API during the server creation process.</p>
<div class="codehilite"><pre><span><code>openstack<span class="w"> server<span class="w"> create<span class="w"> <span class="se">\
<span class="w"> --flavor<span class="w"> m1.tiny<span class="w"> <span class="se">\
<span class="w"> --image<span class="w"> ubuntu<span class="w"> <span class="se">\
<span class="w"> --user-data<span class="w"> setup.yaml<span class="w"> <span class="se">\
<span class="w"> my-automated-server
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Command Analysis</strong>:
* <code>--user-data setup.yaml</code>: Injects the contents of the file <code>setup.yaml</code> into the instance's metadata service. Cloud-Init reads this file upon first boot.</p>
</blockquote>
<h3 id="26-troubleshooting-when-things-go-wrong">2.6 Troubleshooting (When things go wrong)</h3>
<p>A common mistake is assuming that if a server boots, the automation worked. If your script fails (e.g., a syntax error in YAML), the server will still boot, but your app won't be there. To debug this, you must SSH into the server and check the logs:</p>
<ul>
<li><strong><code>/var/log/cloud-init.log</code></strong>: The high-level log of what cloud-init attempted to do.</li>
<li><strong><code>/var/log/cloud-init-output.log</code></strong>: The raw stdout/stderr of your scripts. If your <code>apt-get install</code> failed, the error message will be here.</li>
</ul>
<h3 id="section-2-checkpoint">Section 2 Checkpoint</h3>
<p><strong>Summary</strong>: Cloud-Init is the bridge between a generic OS image and a functional server. It relies on a <strong>Datasource</strong> (Metadata Service) to fetch configuration. It executes in strict <strong>Stages</strong> (Init -&gt; Config -&gt; Final) to ensure the network is ready before attempting to install software. Debugging automation failures requires inspecting the logs inside the VM - , as errors here rarely stop the instance from booting.</p>
<p><strong>Reflection</strong>: Why is the "Magic IP" (<code>169.254.169.254</code>) accessible from inside the VM - without any internet access? (Hint: It is a Link-Local address routed explicitly by the Hypervisor/Neutron platform networking service ).</p>
<p><strong>Resources</strong>:
<a href="https://cloud-init.io/">Cloud-Init Documentation</a></p>
<hr/>
<h2 id="3-automating-with-scripts">3. Automating with Scripts</h2>
<p>Now that we have the tools (CLI, jq, Cloud-Init), let's put them together. The most basic form of automation is <strong>Scripting</strong>.</p>
<h3 id="31-the-bash-loop-imperative">3.1 The "Bash Loop" (Imperative)</h3>
<p>Imagine a scenario where you need to provision a cluster of five servers for a Load Balancing laboratory. Doing this manually is tedious and error-prone. A simple loop can automate the process effectively.</p>
<div class="codehilite"><pre><span><code><span class="ch">#!/bin/bash
<span class="nb">echo<span class="w"> <span class="s2">"Deploying Cluster..."

<span class="k">for<span class="w"> i<span class="w"> <span class="k">in<span class="w"> <span class="o">{<span class="m">1..5<span class="o">}<span class="p">;<span class="w"> <span class="k">do
<span class="w"> <span class="nb">echo<span class="w"> <span class="s2">"Launching web-<span class="nv">$i<span class="s2">..."
<span class="w"> openstack<span class="w"> server<span class="w"> create<span class="w"> <span class="se">\
<span class="w"> --flavor<span class="w"> m1.tiny<span class="w"> <span class="se">\
<span class="w"> --image<span class="w"> cirros<span class="w"> <span class="se">\
<span class="w"> --network<span class="w"> private-net<span class="w"> <span class="se">\
<span class="w"> web-<span class="nv">$i
<span class="k">done
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Script Analysis</strong>:
* <code>for i in {1..5}</code>: Creates a loop that runs 5 times, with variable <code>$i</code> set to 1, 2, 3, 4, 5.
* <code>web-$i</code>: Dynamically names the servers (web-1, web-2...) using the variable.
* <code>--network private-net</code>: Ensures all servers attach to the same internal network.</p>
</blockquote>
<h3 id="32-python-automation-the-sdk">3.2 Python Automation (The SDK)</h3>
<p>While Bash scripts are useful for quick tasks, they often become unmaintainable "spaghetti code" when applied to complex systems. For professional cloud engineering, the <strong>OpenStack platform SDK</strong> (Python) provides a robust alternative.</p>
<p><strong>Why Python?</strong>
Python offers several advantages over shell scripting. First, <strong>Error Handling</strong> is handled gracefully through <code>try/except</code> blocks, preventing the script from crashing unexpectedly. Second, Python's native <strong>Data Structures</strong>, such as Dictionaries and Lists, are far easier to manipulate than parsing string output from a CLI commands. Finally, the logic required for <strong>Idempotency</strong>—checking if a resource exists before attempting to create it—is significantly cleaner to implement.</p>
<h3 id="321-authentication-the-cloudsyaml">3.2.1 Authentication (The <code>clouds.yaml</code>)</h3>
<p>Hardcoding passwords into scripts is a major security risk. Instead, OpenStack platform uses a standardized configuration file named <code>clouds.yaml</code> to decouple credentials from code. When you run a script, the SDK searches for this file in a specific order of precedence:</p>
<ol>
<li><strong>Current Directory</strong>: Checks <code>./clouds.yaml</code> (Good for project-specific configs).</li>
<li><strong>User Config</strong>: Checks <code>~/.config/openstack/clouds.yaml</code> (The standard location for your personal credentials).</li>
<li><strong>System Config</strong>: Checks <code>/etc/openstack/clouds.yaml</code> (Global settings for all users).</li>
</ol>
<p>This allowing you to share your Python script with a colleague without accidentally sharing your password—they simply use their own <code>clouds.yaml</code>.</p>
<p><strong>Example Content (<code>clouds.yaml</code>):</strong></p>
<div class="codehilite"><pre><span><code><span class="nt">clouds<span class="p">:
<span class="w"> <span class="nt">openstack platform <span class="p">:
<span class="w"> <span class="nt">auth<span class="p">:
<span class="w"> <span class="nt">auth_url<span class="p">:<span class="w"> <span class="s">"http://10.0.0.10:5000/v3"
<span class="w"> <span class="nt">username<span class="p">:<span class="w"> <span class="s">"admin"
<span class="w"> <span class="nt">password<span class="p">:<span class="w"> <span class="s">"secret_password"
<span class="w"> <span class="nt">project_name<span class="p">:<span class="w"> <span class="s">"admin"
<span class="w"> <span class="nt">domain_name<span class="p">:<span class="w"> <span class="s">"Default"
<span class="w"> <span class="nt">region_name<span class="p">:<span class="w"> <span class="s">"RegionOne"
<span class="w"> <span class="nt">interface<span class="p">:<span class="w"> <span class="s">"public"
<span class="w"> <span class="nt">identity_api_version<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">3
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Explanation</strong>:
* <code>clouds</code>: The top-level key containing all cloud definitions.
* <code>openstack</code>: The specific <strong>profile name</strong>. In Python, we select this with <code>cloud='openstack'</code>.
* <code>auth_url</code>: The Keystone platform identity/authentication service API endpoint. The SDK sends credentials here to get a token.</p>
</blockquote>
<p><strong>Connecting in Python:</strong></p>
<div class="codehilite"><pre><span><code><span class="kn">from<span class="w"> <span class="nn">openstack platform <span class="w"> <span class="kn">import <span class="n">connection

<span class="c1"># Connect using the 'openstack platform ' profile defined above
<span class="n">conn <span class="o">= <span class="n">connection<span class="o">.<span class="n">from_config<span class="p">(<span class="n">cloud<span class="o">=<span class="s1">'openstack platform '<span class="p">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<h3 id="322-reading-resources-listing-servers">3.2.2 Reading Resources (Listing Servers)</h3>
<p>The SDK returns <strong>Objects</strong>, not text. This means you can access properties like <code>.id</code> or <code>.status</code> directly without complex parsing.</p>
<div class="codehilite"><pre><span><code><span class="nb">print<span class="p">(<span class="s2">"Listing Servers:"<span class="p">)
<span class="n">servers <span class="o">= <span class="n">conn<span class="o">.<span class="n">compute<span class="o">.<span class="n">servers<span class="p">()

<span class="k">for <span class="n">server <span class="ow">in <span class="n">servers<span class="p">:
 <span class="nb">print<span class="p">(<span class="sa">f<span class="s2">"ID: <span class="si">{<span class="n">server<span class="o">.<span class="n">id<span class="si">}<span class="s2"> | Name: <span class="si">{<span class="n">server<span class="o">.<span class="n">name<span class="si">}<span class="s2"> | Status: <span class="si">{<span class="n">server<span class="o">.<span class="n">status<span class="si">}<span class="s2">"<span class="p">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Code Analysis</strong>:
* <code>conn.compute.servers()</code>: Returns a "generator" (an iterable list) of Server objects.
* <code>server.name</code>: We access the data using dot-notation, which is type-safe and cleaner than <code>grep</code>.</p>
</blockquote>
<h3 id="323-creating-resources-the-clean-way">3.2.3 Creating Resources (The Clean Way)</h3>
<p>Creating a server in Python allows us to wrap the logic in a <strong>Try/Except</strong> block to handle failures (like Quota errors) gracefully.</p>
<div class="codehilite"><pre><span><code><span class="k">try<span class="p">:
 <span class="nb">print<span class="p">(<span class="s2">"Creating Server..."<span class="p">)
 <span class="n">server <span class="o">= <span class="n">conn<span class="o">.<span class="n">compute<span class="o">.<span class="n">create_server<span class="p">(
 <span class="n">name<span class="o">=<span class="s2">"web-python-01"<span class="p">,
 <span class="n">image_id<span class="o">=<span class="s2">"cirros-id-here"<span class="p">,
 <span class="n">flavor_id<span class="o">=<span class="s2">"m1.tiny"<span class="p">,
 <span class="n">networks<span class="o">=<span class="p">[{<span class="s2">"uuid"<span class="p">: <span class="s2">"private-net-id"<span class="p">}]
 <span class="p">)
 <span class="c1"># Wait for it to be ready
 <span class="n">conn<span class="o">.<span class="n">compute<span class="o">.<span class="n">wait_for_server<span class="p">(<span class="n">server<span class="p">)
 <span class="nb">print<span class="p">(<span class="sa">f<span class="s2">"Created Server: <span class="si">{<span class="n">server<span class="o">.<span class="n">name<span class="si">}<span class="s2">"<span class="p">)

<span class="k">except <span class="ne">Exception <span class="k">as <span class="n">e<span class="p">:
 <span class="nb">print<span class="p">(<span class="sa">f<span class="s2">"Failed to create server: <span class="si">{<span class="n">e<span class="si">}<span class="s2">"<span class="p">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Code Analysis</strong>:
* <code>create_server()</code>: Accepts arguments as standard Python types (Strings, Lists).
* <code>wait_for_server()</code>: A helper function that pauses the script until the server enters the <code>ACTIVE</code> state, replacing manual <code>sleep</code> loops.
* <code>try/except</code>: If the cloud is full or the network ID is wrong, the script captures the error and prints a friendly message instead of crashing with a stack trace.</p>
</blockquote>
<hr/>
<h2 id="4-infrastructure-as-code-heat-vs-terraform">4. : Heat vs Terraform</h2>
<p>The distinction between "Imperative" scripts (Bash) and "Declarative" (IaC ) is fundamental. Imperative tools describe <em>how</em> to achieve a task step-by-step, whereas Declarative tools describe the desired <em>end state</em>, leaving the "how" to the engine.</p>
<h3 id="41-the-two-giants">4.1 The Two Giants</h3>
<p>Two primary tools dominate this landscape. <strong>Heat</strong> is the OpenStack platform Native orchestration engine. It is built directly into the platform, requires no external installation, and uses YAML templates. It is the ideal choice for pure OpenStack platform environments where external tool dependencies are undesirable. <strong>Terraform</strong>, created by HashiCorp, is the Industry Standard for multi-cloud provisioning. It uses the HashiCorp Configuration Language (HCL) and supports AWS, Azure, Google Cloud, and OpenStack platform simultaneously, making it the dominant skill in the broader job market.</p>
<h3 id="42-syntax-comparison-creating-a-server">4.2 Syntax Comparison (Creating a Server)</h3>
<p><strong>Option A: OpenStack platform Heat (HOT)</strong></p>
<div class="codehilite"><pre><span><code><span class="nt">resources<span class="p">:
<span class="w"> <span class="nt">my_server<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Nova platform compute service for VMs ::Server
<span class="w"> <span class="nt">properties<span class="p">:
<span class="w"> <span class="nt">image<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">ubuntu
<span class="w"> <span class="nt">flavor - template - image for quick deployment defining vCPUs, RAM, and disk <span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">m1.small
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<p><strong>Option B: Terraform (HCL)</strong></p>
<div class="codehilite"><pre><span><code><span class="w"> <span class="na">image_name<span class="w"> <span class="o">=<span class="w"> <span class="s2">"ubuntu"
<span class="w"> <span class="na">flavor_name<span class="w"> <span class="o">=<span class="w"> <span class="s2">"m1.small"
<span class="p">}
</span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Comparison</strong>:
* <strong>Heat</strong>: Uses <code>type: OS::Nova::Server</code> and nested properties.
* <strong>Terraform</strong>: Uses <code>resource "type" "name"</code> and <code>=</code> assignment syntax. Both achieve the exact same result.</p>
<p><strong>Note</strong>: In this course, we focus on <strong>Heat</strong> because it requires no external setup and allows you to understand the underlying OpenStack platform resource model directly. However, in a multi-cloud professional environment, <strong>Terraform</strong> is the tool you will most likely encounter.</p>
</blockquote>
<h3 id="section-4-checkpoint">Section 4 Checkpoint</h3>
<p><strong>Summary</strong>: We have moved from <strong>Imperative</strong> scripts, where we define strict procedural steps, to <strong>Declarative</strong> IaC , where we define the target architecture. A critical property of these modern tools is <strong>Idempotency</strong>—the ability to execute the same script multiple times without causing errors or duplicating resources. If the resource already exists in the desired state, the tool simply does nothing.</p>
<p><strong>Reflection</strong>: Consider why a company using multiple cloud providers (e.g., AWS and on-prem OpenStack platform ) would prefer Terraform over Heat. Also, think about the consequences of removing a resource definition from a Terraform file or Heat template - image for quick deployment ; unlike a script which simply stops running, IaC tools will actively destroy the resource to ensure the real world matches your definition.</p>
<hr/>
<h2 id="5-orchestration-with-heat-the-template-engine">5. Orchestration with Heat (The Template - image for quick deployment Engine)</h2>
<p>Orchestration goes beyond simple resource creation; it manages the dependencies and lifecycle of complex applications. In OpenStack platform , the native Orchestration engine is <strong>Heat</strong>.</p>
<h3 id="51-anatomy-of-a-template">5.1 Anatomy of a Template - image for quick deployment </h3>
<p>Heat uses YAML templates known as <strong>HOT</strong> (Heat Orchestration Templates). Every template - image for quick deployment follows a standard skeleton:</p>
<ol>
<li><strong>Version</strong>: <code>heat_template_version: 2018-08-31</code> tells Heat which features are available.</li>
<li><strong>Parameters</strong>: Inputs provided by the user at runtime (e.g., SSH Key Name, Server Flavor - template - image for quick deployment defining vCPUs, RAM, and disk ).</li>
<li><strong>Resources</strong>: The actual infrastructure to build (VMs, Networks, Volumes).</li>
<li><strong>Outputs</strong>: Information returned to the user after deployment (e.g., The Website URL).</li>
</ol>
<div class="codehilite"><pre><span><code><span class="nt">heat_template_version<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">2018-08-31
<span class="nt">description<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">A skeleton template - image for quick deployment 

<span class="nt">parameters<span class="p">:
<span class="w"> <span class="c1"># Inputs defined here

<span class="nt">resources<span class="p">:
<span class="w"> <span class="c1"># Infrastructure defined here

<span class="nt">outputs<span class="p">:
<span class="w"> <span class="c1"># Return values defined here
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Structure Analysis</strong>:
* <strong>Version</strong>: Always required. Defines the syntax version (HOT 2018-08-31 is standard for Queens/Rocky releases).
* <strong>Parameters</strong>: Variables passed <em>in</em> (Input).
* <strong>Outputs</strong>: Variables passed <em>out</em> (Return values).</p>
</blockquote>
<h3 id="52-building-blocks-primitives">5.2 Building Blocks (Primitives)</h3>
<p>Rather than writing a massive script immediately, let's look at how to create individual components.</p>
<p><strong>Creating a Network</strong></p>
<div class="codehilite"><pre><span><code><span class="nt">resources<span class="p">:
<span class="w"> <span class="nt">my_private_net<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Neutron platform networking service ::Net
<span class="w"> <span class="nt">properties<span class="p">:
<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">deep-dive-net
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Resource Analysis</strong>:
* <code>resources</code>: The top-level keyword indicating the start of the infrastructure definition block.
* <code>my_private_net</code>: The <strong>Logical ID</strong> (Variable Name) used to reference this resource elsewhere in the template - image for quick deployment .
* <code>type</code>: The specific OpenStack platform resource class (e.g., <code>OS::Neutron::Net</code>).
* <code>properties</code>: Configuration specific to that resource (like the network name).</p>
</blockquote>
<p><strong>Creating a Security Group</strong></p>
<div class="codehilite"><pre><span><code><span class="nt">resources<span class="p">:
<span class="w"> <span class="nt">my_security_group<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Neutron platform networking service ::SecurityGroup
<span class="w"> <span class="nt">properties<span class="p">:
<span class="w"> <span class="nt">rules<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">protocol<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">tcp
<span class="w"> <span class="nt">port_range_min<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">80
<span class="w"> <span class="nt">port_range_max<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">80
<span class="w"> <span class="nt">remote_ip_prefix<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Resource Analysis</strong>:
* <code>rules</code>: OpenStack platform Security Groups are <strong>Default Deny</strong>. No traffic is allowed unless explicitly permitted here.
* <code>protocol</code>: The definition (tcp, udp, icmp).
* <code>port_range_min/max</code>: The port range (80 to 80 means just port 80).
* <code>remote_ip_prefix</code>: Defines <strong>Who</strong> can access this port (The Source). <code>0.0.0.0/0</code> is CIDR notation for "The entire internet." For specific networks, you would use something like <code>192.168.1.0/24</code>.</p>
</blockquote>
<p><strong>Creating a Block Storage Volume</strong></p>
<div class="codehilite"><pre><span><code><span class="nt">resources<span class="p">:
<span class="w"> <span class="nt">my_data_volume<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Cinder platform block storage service ::Volume
<span class="w"> <span class="nt">properties<span class="p">:
<span class="w"> <span class="nt">size<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">10
<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">db_data
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Resource Analysis</strong>:
* <code>my_data_volume</code>: The Logical ID.
* <code>type: OS::Cinder::Volume</code>: Explicitly creates a block device in Cinder platform block storage service .
* <code>size</code>: The capacity in Gigabytes (GB).
* <code>name</code>: The display name visible in the dashboard.</p>
</blockquote>
<p><strong>Creating a Virtual Machine</strong></p>
<div class="codehilite"><pre><span><code><span class="nt">resources<span class="p">:
<span class="w"> <span class="nt">my_server<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Nova platform compute service for VMs ::Server
<span class="w"> <span class="nt">properties<span class="p">:
<span class="w"> <span class="nt">image<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">ubuntu
<span class="w"> <span class="nt">flavor - template - image for quick deployment defining vCPUs, RAM, and disk <span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">m1.small
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Resource Analysis</strong>:
* <code>my_server</code>: The Logical ID.
* <code>type: OS::Nova::Server</code>: The standard compute instance type.
* <code>image</code> / <code>flavor</code>: The <strong>Mandatory</strong> properties defining the specs.
* <strong>Note</strong>: There are many other optional properties not shown here, such as <code>key_name</code> (SSH Access), <code>networks</code> (Connectivity), <code>security_groups</code> (Firewall), and <code>user_data</code> (Cloud-Init Scripts). We will combine these in the Unified Stack example below.</p>
</blockquote>
<h3 id="53-the-unified-stack">5.3 The Unified Stack</h3>
<p>The true power of Heat comes from combining these primitives using <strong>Intrinsic Functions</strong>.</p>
<ul>
<li><code>{ get_resource: X }</code>: Gets the ID of resource X.</li>
<li><code>{ get_param: Y }</code>: Gets the value of user input Y.</li>
<li><code>{ get_attr: [Z, val] }</code>: Gets a specific attribute (like an IP address) from resource Z.</li>
</ul>
<p><strong>Full Deployment Example (<code>deployment.yaml</code>):</strong></p>
<div class="codehilite"><pre><span><code><span class="nt">heat_template_version<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">2018-08-31
<span class="nt">description<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">Full Stack Deployment with Nginx and Floating IP

<span class="nt">parameters<span class="p">:
<span class="w"> <span class="nt">key_name<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">string
<span class="w"> <span class="nt">description<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">Name of an existing KeyPair to use
<span class="w"> <span class="nt">public_net_id<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">string
<span class="w"> <span class="nt">description<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">ID of the external network (e.g., public-net)

<span class="nt">resources<span class="p">:
<span class="w"> <span class="c1"># 1. The Network
<span class="w"> <span class="nt">app_net<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Neutron platform networking service ::Net

<span class="w"> <span class="nt">app_subnet<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Neutron platform networking service ::Subnet
<span class="w"> <span class="nt">properties<span class="p">:
<span class="w"> <span class="nt">network<span class="p">:<span class="w"> <span class="p p-Indicator">{<span class="nt"> get_resource<span class="p">:<span class="w"> <span class="nv">app_net<span class="w"> <span class="p p-Indicator">}
<span class="w"> <span class="nt">cidr<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">192.168.10.0/24

<span class="w"> <span class="c1"># 2. The Security Group
<span class="w"> <span class="nt">web_sg<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Neutron platform networking service ::SecurityGroup
<span class="w"> <span class="nt">properties<span class="p">:
<span class="w"> <span class="nt">rules<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">protocol<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">tcp
<span class="w"> <span class="nt">port_range_min<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">80
<span class="w"> <span class="nt">port_range_max<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">80
<span class="w"> <span class="nt">remote_ip_prefix<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">protocol<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">icmp
<span class="w"> <span class="nt">remote_ip_prefix<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0

<span class="w"> <span class="c1"># 3. The Server
<span class="w"> <span class="nt">web_instance<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Nova platform compute service for VMs ::Server
<span class="w"> <span class="nt">properties<span class="p">:
<span class="w"> <span class="nt">image<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">ubuntu_focal
<span class="w"> <span class="nt">flavor - template - image for quick deployment defining vCPUs, RAM, and disk <span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">m1.small
<span class="w"> <span class="nt">key_name<span class="p">:<span class="w"> <span class="p p-Indicator">{<span class="nt"> get_param<span class="p">:<span class="w"> <span class="nv">key_name<span class="w"> <span class="p p-Indicator">}
<span class="w"> <span class="nt">networks<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">network<span class="p">:<span class="w"> <span class="p p-Indicator">{<span class="nt"> get_resource<span class="p">:<span class="w"> <span class="nv">app_net<span class="w"> <span class="p p-Indicator">}
<span class="w"> <span class="nt">security_groups<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="p p-Indicator">{<span class="nt"> get_resource<span class="p">:<span class="w"> <span class="nv">web_sg<span class="w"> <span class="p p-Indicator">}
<span class="w"> <span class="nt">user_data<span class="p">:<span class="w"> <span class="p p-Indicator">|
<span class="w"> <span class="no">#cloud-config
<span class="w"> <span class="no">packages:
<span class="w"> <span class="no">- docker.io

<span class="w"> <span class="no">runcmd:
<span class="w"> <span class="no">- systemctl enable docker
<span class="w"> <span class="no">- systemctl start docker
<span class="w"> <span class="no">- docker run -d -p 80:80 nginx

<span class="w"> <span class="c1"># 4. Floating IP (The Bridge to Internet)
<span class="w"> <span class="nt">my_floating_ip<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Neutron platform networking service ::FloatingIP
<span class="w"> <span class="nt">properties<span class="p">:
<span class="w"> <span class="nt">floating_network<span class="p">:<span class="w"> <span class="p p-Indicator">{<span class="nt"> get_param<span class="p">:<span class="w"> <span class="nv">public_net_id<span class="w"> <span class="p p-Indicator">}

<span class="w"> <span class="c1"># 5. The Association (Connecting IP to Server)
<span class="w"> <span class="nt">association<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">OS::Neutron platform networking service ::FloatingIPAssociation
<span class="w"> <span class="nt">properties<span class="p">:
<span class="w"> <span class="nt">floatingip_id<span class="p">:<span class="w"> <span class="p p-Indicator">{<span class="nt"> get_resource<span class="p">:<span class="w"> <span class="nv">my_floating_ip<span class="w"> <span class="p p-Indicator">}
<span class="w"> <span class="nt">port_id<span class="p">:<span class="w"> <span class="p p-Indicator">{<span class="nt"> get_attr<span class="p">:<span class="w"> <span class="p p-Indicator">[<span class="nv">web_instance<span class="p p-Indicator">,<span class="w"> <span class="nv">addresses<span class="p p-Indicator">,<span class="w"> <span class="p p-Indicator">{<span class="nt"> get_resource<span class="p">:<span class="w"> <span class="nv">app_net<span class="w"> <span class="p p-Indicator">},<span class="w"> <span class="nv">0<span class="p p-Indicator">,<span class="w"> <span class="nv">port<span class="p p-Indicator">]<span class="w"> <span class="p p-Indicator">}

<span class="nt">outputs<span class="p">:
<span class="w"> <span class="nt">website_url<span class="p">:
<span class="w"> <span class="nt">description<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">The Public URL of the deployed application
<span class="w"> <span class="nt">value<span class="p">:<span class="w"> <span class="p p-Indicator">{<span class="nt"> get_attr<span class="p">:<span class="w"> <span class="p p-Indicator">[<span class="nv">my_floating_ip<span class="p p-Indicator">,<span class="w"> <span class="nv">floating_ip_address<span class="p p-Indicator">]<span class="w"> <span class="p p-Indicator">}
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Stack Analysis</strong>:
* <strong>Floating IP</strong>: We created a <code>FloatingIP</code> resource on the public network and then an <code>Association</code> resource to link it to our server. This is how the server becomes accessible from your laptop.
* <strong>User Data</strong>: We embedded a <strong>Cloud-Config</strong> payload to install Docker and launch Nginx as a container. Heat injects this into Cloud-Init, which executes the declarative instructions on boot.
* <strong>Dependency Chain</strong>: The <code>association</code> depends on both the <code>floating_ip</code> and the <code>web_instance</code>. Heat orchestrates this perfectly.</p>
</blockquote>
<h3 id="54-the-terraform-translation-rosetta-stone">5.4 The Terraform Translation (Rosetta Stone)</h3>
<p>To prove that these skills are transferable, here is the exact same Nginx server we built in Heat, translated into Terraform. Notice that while the keywords differ (<code>resources</code> vs <code>resource</code>), the structural logic—defining a network, security group, and server with dependencies—is identical.</p>
<p><strong>Terraform (main.tf)</strong></p>
<div class="codehilite"><pre><span><code><span class="kr">variable<span class="w"> <span class="nv">"key_name"<span class="w"> <span class="p">{}
<span class="kr">variable<span class="w"> <span class="nv">"public_net_id"<span class="w"> <span class="p">{}

<span class="c1"># 1. The Network
<span class="kr">resource<span class="w"> <span class="nc">"openstack_networking_network_v2"<span class="w"> <span class="nv">"app_net"<span class="w"> <span class="p">{
<span class="w"> <span class="na">name<span class="w"> <span class="o">=<span class="w"> <span class="s2">"app_net"
<span class="p">}

<span class="kr">resource<span class="w"> <span class="nc">"openstack_networking_subnet_v2"<span class="w"> <span class="nv">"app_subnet"<span class="w"> <span class="p">{
<span class="w"> <span class="na">network_id<span class="w"> <span class="o">=<span class="w"> <span class="nv">openstack_networking_network_v2.app_net.id
<span class="w"> <span class="na">cidr<span class="w"> <span class="o">=<span class="w"> <span class="s2">"192.168.10.0/24"
<span class="p">}

<span class="c1"># 2. The Security Group
<span class="kr">resource<span class="w"> <span class="nc">"openstack_networking_secgroup_v2"<span class="w"> <span class="nv">"web_sg"<span class="w"> <span class="p">{
<span class="w"> <span class="na">name<span class="w"> <span class="o">=<span class="w"> <span class="s2">"web_sg"
<span class="w"> <span class="na">description<span class="w"> <span class="o">=<span class="w"> <span class="s2">"Web Security Group"
<span class="p">}

<span class="kr">resource<span class="w"> <span class="nc">"openstack_networking_secgroup_rule_v2"<span class="w"> <span class="nv">"http_rule"<span class="w"> <span class="p">{
<span class="w"> <span class="na">direction<span class="w"> <span class="o">=<span class="w"> <span class="s2">"ingress"
<span class="w"> <span class="na">ethertype<span class="w"> <span class="o">=<span class="w"> <span class="s2">"IPv4"
<span class="w"> <span class="na">protocol<span class="w"> <span class="o">=<span class="w"> <span class="s2">"tcp"
<span class="w"> <span class="na">port_range_min<span class="w"> <span class="o">=<span class="w"> <span class="m">80
<span class="w"> <span class="na">port_range_max<span class="w"> <span class="o">=<span class="w"> <span class="m">80
<span class="w"> <span class="na">remote_ip_prefix<span class="w"> <span class="o">=<span class="w"> <span class="s2">"0.0.0.0/0"
<span class="w"> <span class="na">security_group_id<span class="w"> <span class="o">=<span class="w"> <span class="nv">openstack_networking_secgroup_v2.web_sg.id
<span class="p">}

<span class="c1"># 3. The Server
<span class="kr">resource<span class="w"> <span class="nc">"openstack_compute_instance_v2"<span class="w"> <span class="nv">"web_instance"<span class="w"> <span class="p">{
<span class="w"> <span class="na">name<span class="w"> <span class="o">=<span class="w"> <span class="s2">"web-server"
<span class="w"> <span class="na">image_name<span class="w"> <span class="o">=<span class="w"> <span class="s2">"ubuntu_focal"
<span class="w"> <span class="na">flavor_name<span class="w"> <span class="o">=<span class="w"> <span class="s2">"m1.small"
<span class="w"> <span class="na">key_pair<span class="w"> <span class="o">=<span class="w"> <span class="nv">var.key_name
<span class="w"> <span class="na">user_data<span class="w"> <span class="o">=<span class="w"> <span class="o">&lt;&lt;-<span class="dl">EOF
<span class="sh"> #cloud-config
<span class="sh"> packages:
<span class="sh"> - docker.io
<span class="sh"> runcmd:
<span class="sh"> - systemctl start docker
<span class="sh"> - docker run -d -p 80:80 nginx
<span class="dl"> EOF

<span class="w"> <span class="nb">network<span class="w"> <span class="p">{
<span class="w"> <span class="na">uuid<span class="w"> <span class="o">=<span class="w"> <span class="nv">openstack_networking_network_v2.app_net.id
<span class="w"> <span class="p">}
<span class="p">}

<span class="c1"># 4. Floating IP
<span class="kr">resource<span class="w"> <span class="nc">"openstack_networking_floatingip_v2"<span class="w"> <span class="nv">"my_floating_ip"<span class="w"> <span class="p">{
<span class="w"> <span class="na">pool<span class="w"> <span class="o">=<span class="w"> <span class="nv">var.public_net_id
<span class="p">}

<span class="c1"># 5. Association
<span class="kr">resource<span class="w"> <span class="nc">"openstack_compute_floatingip_associate_v2"<span class="w"> <span class="nv">"association"<span class="w"> <span class="p">{
<span class="w"> <span class="na">floating_ip<span class="w"> <span class="o">=<span class="w"> <span class="nv">openstack_networking_floatingip_v2.my_floating_ip.address
<span class="w"> <span class="na">instance_id<span class="w"> <span class="o">=<span class="w"> <span class="nv">openstack_compute_instance_v2.web_instance.id
<span class="p">}

<span class="kr">output<span class="w"> <span class="nv">"website_url"<span class="w"> <span class="p">{
<span class="w"> <span class="na">value<span class="w"> <span class="o">=<span class="w"> <span class="nv">openstack_networking_floatingip_v2.my_floating_ip.address
<span class="p">}
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Translation Analysis</strong>:
* <strong>References</strong>: Heat uses <code>get_resource</code>. Terraform uses <code>resource_type.resource_name.id</code>.
* <strong>Structure</strong>: Both tools define resources, properties, and dependencies. The syntax changes (YAML vs HCL), but the <em>concepts</em> are universal. By learning Heat, you are effectively learning the logic needed for Terraform.</p>
</blockquote>
<h3 id="55-beyond-single-vms-magnum-kubernetes">5.5 Beyond Single VMs: Magnum (Kubernetes orchestration platform )</h3>
<p>In Section 5.3, we installed Docker on a <strong>single VM - </strong>. While fine for development, production requires clusters. </p>
<p><strong>OpenStack platform Magnum</strong> is the service that bridges Heat and Containers.</p>
<ul>
<li><strong>Orchestration</strong>: Magnum uses <strong>Heat</strong> under the hood to deploy a stack.</li>
<li><strong>Resources</strong>: It automatically creates the <strong>Master Nodes</strong>, <strong>Worker Nodes</strong>, <strong>Load Balancers</strong>, and <strong>Private Networks</strong>.</li>
<li><strong>Result</strong>: Instead of a VM - with Docker, you get a fully manageable <strong>Kubernetes orchestration platform Cluster</strong>.</li>
</ul>
<p>To deploy a production-grade Kubernetes orchestration platform cluster on OpenStack platform , we use the <strong>Magnum CLI</strong>. This happens in 3 phases:</p>
<p><strong>Phase 1: Create the Cluster Template - image for quick deployment </strong>
This defines the "Shape" of the cluster (OS Image, Keypair, Network Driver).</p>
<div class="codehilite"><pre><span><code>openstack<span class="w"> coe<span class="w"> cluster<span class="w"> template<span class="w"> create<span class="w"> k8s-template<span class="w"> <span class="se">\
<span class="w"> --image<span class="w"> fedora-coreos-35<span class="w"> <span class="se">\
<span class="w"> --keypair<span class="w"> mykey<span class="w"> <span class="se">\
<span class="w"> --external-network<span class="w"> public<span class="w"> <span class="se">\
<span class="w"> --dns-nameserver<span class="w"> <span class="m">8.8.8.8<span class="w"> <span class="se">\
<span class="w"> --flavor<span class="w"> m1.medium<span class="w"> <span class="se">\
<span class="w"> --master-flavor<span class="w"> m1.medium<span class="w"> <span class="se">\
<span class="w"> --coe<span class="w"> kubernetes
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Command Analysis</strong>:
* <code>template create</code>: Sets the blueprint.
* <code>--image</code>: Magnum requires special Fedora Atomic or CoreOS images optimized for containers, not standard Ubuntu.
* <code>--coe</code>: Specifies the engine. Magnum also supports Docker Swarm and Apache Mesos, but Kubernetes orchestration platform is the standard.</p>
</blockquote>
<p><strong>Phase 2: Launch the Cluster</strong>
This triggers Heat to actually build the stack (VMs, Load Balancers, Security Groups).</p>
<div class="codehilite"><pre><span><code>openstack<span class="w"> coe<span class="w"> cluster<span class="w"> create<span class="w"> k8s-cluster<span class="w"> <span class="se">\
<span class="w"> --template<span class="w"> k8s-template<span class="w"> <span class="se">\
<span class="w"> --master-count<span class="w"> <span class="m">1<span class="w"> <span class="se">\
<span class="w"> --node-count<span class="w"> <span class="m">2
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Command Analysis</strong>:
* <code>cluster create</code>: The trigger. This tells Heat to start provisioning resources.
* <code>--master-count</code>: High Availability (HA - System design for minimal downtime ) starts at 3 masters, but for labs, 1 is sufficient.
* <code>--node-count</code>: The number of workers where your actual Pods (like Nginx) will run.</p>
</blockquote>
<p><strong>Phase 3: Configure Client Access</strong>
Once the cluster is <code>CREATE_COMPLETE</code>, we download the credentials to talk to it.</p>
<div class="codehilite"><pre><span><code>mkdir<span class="w"> -p<span class="w"> ~/.kube
openstack<span class="w"> coe<span class="w"> cluster<span class="w"> config<span class="w"> k8s-cluster<span class="w"> &gt;<span class="w"> ~/.kube/config
<span class="nb">export<span class="w"> <span class="nv">KUBECONFIG<span class="o">=~/.kube/config
kubectl<span class="w"> get<span class="w"> nodes
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Command Analysis</strong>:
* <code>cluster config</code>: This command fetches the TLS certificates and API endpoints from OpenStack platform .
* <code>export KUBECONFIG</code>: Tells the <code>kubectl</code> tool where to find these credentials. Without this, <code>kubectl</code> doesn't know which cluster to talk to.</p>
</blockquote>
<h3 id="551-step-4-deploying-workloads-pods-vs-vms">5.5.1 Step 4: Deploying Workloads (Pods vs VMs)</h3>
<p>Now that the cluster is running, we stop talking to OpenStack platform (Heat) and start talking to Kubernetes orchestration platform (<code>kubectl</code>). Here is how we deploy Nginx with <strong>3 Replicas</strong> (Load Balanced).</p>
<p><strong>Kubernetes orchestration platform Manifest (<code>nginx-deployment.yaml</code>)</strong></p>
<div class="codehilite"><pre><span><code><span class="nt">apiVersion<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">apps/v1
<span class="nt">kind<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">Deployment
<span class="nt">metadata<span class="p">:
<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">nginx-cluster
<span class="nt">spec<span class="p">:
<span class="w"> <span class="nt">replicas<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">3<span class="w"> <span class="c1"># The Power of K8s: 3 Copies automatically managed
<span class="w"> <span class="nt">selector<span class="p">:
<span class="w"> <span class="nt">matchLabels<span class="p">:
<span class="w"> <span class="nt">app<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">web
<span class="w"> <span class="nt">template - image for quick deployment <span class="p">:
<span class="w"> <span class="nt">metadata<span class="p">:
<span class="w"> <span class="nt">labels<span class="p">:
<span class="w"> <span class="nt">app<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">web
<span class="w"> <span class="nt">spec<span class="p">:
<span class="w"> <span class="nt">containers<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">nginx
<span class="w"> <span class="nt">image<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">docker.io/nginx:latest
<span class="w"> <span class="nt">ports<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">containerPort<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">80
<span class="nn">---
<span class="nt">apiVersion<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">v1
<span class="nt">kind<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">Service
<span class="nt">metadata<span class="p">:
<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">nginx-lb
<span class="nt">spec<span class="p">:
<span class="w"> <span class="nt">type<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">LoadBalancer<span class="w"> <span class="c1"># OpenStack platform will create a physical Load Balancer for this
<span class="w"> <span class="nt">selector<span class="p">:
<span class="w"> <span class="nt">app<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">web
<span class="w"> <span class="nt">ports<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">port<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">80
<span class="w"> <span class="nt">targetPort<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">80
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Stack Analysis</strong>:
* <strong>Replicas: 3</strong>: Instead of creating <code>web_server_01</code>, <code>web_server_02</code>, etc., we simply ask for "3 copies". Kubernetes orchestration platform ensures they are always running.
* <strong>Service (LoadBalancer)</strong>: This object talks to OpenStack platform Neutron platform networking service /Octavia to provision a real Load Balancer that distributes traffic to those 3 pods.</p>
</blockquote>
<h3 id="section-5-checkpoint">Section 5 Checkpoint</h3>
<p><strong>Summary</strong>: Heat templates allow us to define an entire infrastructure stack in a single file. By understanding the core structure (Parameters, Resources, Outputs) and the Building Blocks (Cinder platform block storage service , Nova platform compute service for VMs , Neutron platform networking service resources), we can assemble complex environments that are consistently reproducible.</p>
<p><strong>Reflection</strong>: Why is it better to define the Security Group inside the template - image for quick deployment rather than assuming it already exists? (Hint: It makes the template - image for quick deployment "self-contained" and easier to deploy in a fresh project).</p>
<hr/>
<h2 id="6-configuration-management-with-ansible">6. Configuration Management with Ansible</h2>
<p>We have now learned how to create servers using Heat () and how to bootstrap them using Cloud-Init. But what happens on <strong>Day 2</strong>? How do you patch 50 servers? How do you update a config file on all of them? Rebuilding the entire stack with Heat every time you need to change a comma in a config file is inefficient.</p>
<p><strong>Ansible</strong> is the industry-standard tool for this phase. It is an agentless automation engine that connects to your servers via SSH and enforces a desired state.</p>
<h3 id="61-the-inventory">6.1 The Inventory</h3>
<p>Ansible needs to know <em>what</em> it is managing. This is defined in an <strong>Inventory</strong> file. While it supports a simple INI format, YAML is preferred for clarity.</p>
<p><strong>Example Inventory (<code>hosts.yaml</code>):</strong></p>
<div class="codehilite"><pre><span><code><span class="nt">all<span class="p">:
<span class="w"> <span class="nt">children<span class="p">:
<span class="w"> <span class="nt">webservers<span class="p">:
<span class="w"> <span class="nt">hosts<span class="p">:
<span class="w"> <span class="nt">web-01<span class="p">:
<span class="w"> <span class="nt">ansible_host<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">192.168.1.10
<span class="w"> <span class="nt">web-02<span class="p">:
<span class="w"> <span class="nt">ansible_host<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">192.168.1.11
<span class="w"> <span class="nt">databases<span class="p">:
<span class="w"> <span class="nt">hosts<span class="p">:
<span class="w"> <span class="nt">db-01<span class="p">:
<span class="w"> <span class="nt">ansible_host<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">192.168.1.20
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Inventory Analysis</strong>:
* <code>all</code>: The root group containing every server.
* <code>children</code>: Sub-groups (e.g., <code>webservers</code>, <code>databases</code>) allow you to target specific roles.
* <code>ansible_host</code>: Variable defining the actual IP to connect to.</p>
</blockquote>
<h3 id="62-ad-hoc-commands">6.2 Ad-Hoc Commands</h3>
<p>For quick, one-off tasks, you don't need to write a script. You can simply "speak" to your cluster using the CLI.</p>
<div class="codehilite"><pre><span><code><span class="c1"># Ping all servers
ansible<span class="w"> all<span class="w"> -m<span class="w"> ping<span class="w"> -i<span class="w"> hosts.yaml

<span class="c1"># Check uptime on webservers only
ansible<span class="w"> webservers<span class="w"> -m<span class="w"> shell<span class="w"> -a<span class="w"> <span class="s2">"uptime"<span class="w"> -i<span class="w"> hosts.yaml
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Command Analysis</strong>:
* <code>all</code> / <code>webservers</code>: The target group from the inventory.
* <code>-m ping</code>: The <strong>Module</strong> to run. 'ping' in Ansible checks SSH connectivity and Python availability, not ICMP.
* <code>-a</code>: Arguments passed to the module.</p>
</blockquote>
<h3 id="63-playbooks-the-core">6.3 Playbooks (The Core)</h3>
<p>While Ad-Hoc commands are useful, the real power lies in <strong>Playbooks</strong>. These are YAML files that describe a complex set of tasks—a "play."</p>
<p><strong>Example Playbook (<code>site.yaml</code>):</strong></p>
<div class="codehilite"><pre><span><code><span class="p p-Indicator">-<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">Configure Web Servers
<span class="w"> <span class="nt">hosts<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">webservers
<span class="w"> <span class="nt">become<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">yes<span class="w"> <span class="c1"># Run as sudo
<span class="w"> <span class="nt">tasks<span class="p">:
<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">Ensure Apache is installed
<span class="w"> <span class="nt">apt<span class="p">:
<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">apache2
<span class="w"> <span class="nt">state<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">present

<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">Deploy custom index page
<span class="w"> <span class="nt">copy<span class="p">:
<span class="w"> <span class="nt">content<span class="p">:<span class="w"> <span class="s">"&lt;h1&gt;Managed<span class="nv"> <span class="s">by<span class="nv"> <span class="s">Ansible"
<span class="w"> <span class="nt">dest<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">/var/www/html/index.html

<span class="w"> <span class="p p-Indicator">-<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">Ensure Service is Running
<span class="w"> <span class="nt">service<span class="p">:
<span class="w"> <span class="nt">name<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">apache2
<span class="w"> <span class="nt">state<span class="p">:<span class="w"> <span class="l l-Scalar l-Scalar-Plain">started
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Playbook Analysis</strong>:
* <code>apt</code>, <code>copy</code>, <code>service</code>: These are <strong>Modules</strong>. They abstract away the OS details (e.g., you don't type <code>apt-get install</code>, you just say <code>state: present</code>).
* <strong>Idempotency</strong>: This is the most critical concept. If you run this playbook 100 times, it will only make changes the first time. On subsequent runs, it checks "Is Apache present?", sees "Yes", and does nothing. This makes it safe to run against production systems repeatedly.</p>
</blockquote>
<h3 id="64-the-unified-pipeline-integration">6.4 The Unified Pipeline (Integration)</h3>
<p>The ultimate goal is to chain these tools together. A simple Bash script can act as the "glue" that triggers Heat to build the infrastructure, waits for the output, and then passes that information to Ansible for configuration.</p>
<p><strong>Example: <code>deploy.sh</code></strong></p>
<div class="codehilite"><pre><span><code><span class="ch">#!/bin/bash

<span class="c1"># 1. Launch Infrastructure with Heat
<span class="nb">echo<span class="w"> <span class="s2">"Step 1: Creating Stack..."
openstack<span class="w"> stack<span class="w"> create<span class="w"> -t<span class="w"> deployment.yaml<span class="w"> -p<span class="w"> <span class="nv">key_name<span class="o">=mykey<span class="w"> my-stack

<span class="c1"># 2. Wait for completion (Simple loop)
<span class="nb">echo<span class="w"> <span class="s2">"Step 2: Waiting for IP..."
<span class="k">while<span class="w"> true<span class="p">;<span class="w"> <span class="k">do
<span class="w"> <span class="nv">STATUS<span class="o">=<span class="k">$(openstack<span class="w"> stack<span class="w"> show<span class="w"> my-stack<span class="w"> -f<span class="w"> json<span class="w"> <span class="p">|<span class="w"> jq<span class="w"> -r<span class="w"> .stack_status<span class="k">)
<span class="w"> <span class="k">if<span class="w"> <span class="o">[<span class="w"> <span class="s2">"<span class="nv">$STATUS<span class="s2">"<span class="w"> <span class="o">==<span class="w"> <span class="s2">"CREATE_COMPLETE"<span class="w"> <span class="o">]<span class="p">;<span class="w"> <span class="k">then<span class="w"> <span class="k">break<span class="p">;<span class="w"> <span class="k">fi
<span class="w"> sleep<span class="w"> <span class="m">5
<span class="k">done

<span class="c1"># 3. Extract the IP Address (Output)
<span class="nv">IP<span class="o">=<span class="k">$(openstack<span class="w"> stack<span class="w"> show<span class="w"> my-stack<span class="w"> -f<span class="w"> json<span class="w"> <span class="p">|<span class="w"> jq<span class="w"> -r<span class="w"> <span class="s1">'.outputs[] | select(.output_key=="website_url") | .output_value'<span class="k">)
<span class="nb">echo<span class="w"> <span class="s2">"deployed at <span class="nv">$IP<span class="s2">"

<span class="c1"># 4. Generate Inventory for Ansible
<span class="nb">echo<span class="w"> <span class="s2">"[webservers]"<span class="w"> &gt;<span class="w"> hosts.ini
<span class="nb">echo<span class="w"> <span class="s2">"<span class="nv">$IP<span class="s2"> ansible_user=ubuntu"<span class="w"> &gt;&gt;<span class="w"> hosts.ini

<span class="c1"># 5. Run Configuration
<span class="nb">echo<span class="w"> <span class="s2">"Step 3: Configuring with Ansible..."
ansible-playbook<span class="w"> -i<span class="w"> hosts.ini<span class="w"> site.yaml
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Pipeline Analysis</strong>:
* <strong>Glue Code</strong>: Bash is used here not to manage resources, but to manage <em>tools</em>. It bridges the gap between Heat (Infrastructure) and Ansible (Config).
* <strong>Dynamic Inventory</strong>: Note how we create <code>hosts.ini</code> on the fly. <em>Note: <code>ansible_user=ubuntu</code> assumes an Ubuntu image; adjust this for Rocky/CentOS (<code>rocky</code>) or Fedora (<code>fedora</code>).</em></p>
</blockquote>
<h3 id="section-6-checkpoint">Section 6 Checkpoint</h3>
<p><strong>Summary</strong>: Ansible fills the gap of "Day 2 Operations." It uses an <strong>Inventory</strong> to group servers and <strong>Playbooks</strong> to define their configuration. Unlike a Bash script which runs blindly, Ansible is <strong>Idempotent</strong>—it only acts if the system is not in the desired state.</p>
<p><strong>Reflection</strong>: Compare this to the Bash script in Section 3. If you ran that Bash script twice, it would try to create the servers again (and fail). If you run an Ansible playbook twice, it simply reports "OK" (No Change).</p>
<hr/>
<hr/>
<h2 id="7-version-control-managing-your-templates">7. Version Control: Managing your Templates</h2>
<p>Treating means your templates (<code>deployment.yaml</code>) and playbooks (<code>site.yaml</code>) are valuable assets. They should not live in a folder on your laptop; they should be managed in a <strong>Version Control System</strong> like <strong>Git</strong>.</p>
<h3 id="71-why-git">7.1 Why Git?</h3>
<ul>
<li><strong>History</strong>: "Who changed the firewall rule last Tuesday?" Git tells you exactly who and why.</li>
<li><strong>Rollback</strong>: If a new template - image for quick deployment breaks production, <code>git revert</code> allows you to instantly return to the working version.</li>
<li><strong>Collaboration</strong>: Multiple engineers can work on the same stack without overwriting each other's files.</li>
</ul>
<h3 id="72-the-basic-workflow">7.2 The Basic Workflow</h3>
<p>Students are expected to manage their Capstone project using these commands:</p>
<div class="codehilite"><pre><span><code><span class="c1"># Initialize a repository
git<span class="w"> init

<span class="c1"># Add your templates
git<span class="w"> add<span class="w"> deployment.yaml<span class="w"> site.yaml

<span class="c1"># Save a snapshot - (Checkpoint)
git<span class="w"> commit<span class="w"> -m<span class="w"> <span class="s2">"Added Nginx installation to Heat template - image for quick deployment "

<span class="c1"># View History
git<span class="w"> log
</span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre></div>
<blockquote>
<p><strong>Git Analysis</strong>:
* <code>commit</code>: This is your "Save Game" button. Make a commit every time you reach a stable state (e.g., "Heat template - image for quick deployment works", "Ansible connects").
* <strong>GitOps</strong>: In advanced environments, applying a commit to a Git repository automatically triggers the <code>deploy.sh</code> pipeline we wrote above. This is known as <strong>GitOps</strong>.</p>
</blockquote>
<h3 id="73-strategic-summary">7.3 Strategic Summary</h3>
<p>To help you lock in the mental model of <strong>"Which Tool, When?"</strong>, review this comparison:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Tool</th>
<th style="text-align: left;">Phase</th>
<th style="text-align: left;">Scope</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Cloud-Init</strong></td>
<td style="text-align: left;">Boot time</td>
<td style="text-align: left;">Single VM - </td>
</tr>
<tr>
<td style="text-align: left;"><strong>Bash</strong></td>
<td style="text-align: left;">Glue</td>
<td style="text-align: left;">Tool orchestration</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Python SDK</strong></td>
<td style="text-align: left;">API automation</td>
<td style="text-align: left;">Fine-grained logic</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Heat</strong></td>
<td style="text-align: left;">Infrastructure</td>
<td style="text-align: left;">Declarative Stacks</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Magnum</strong></td>
<td style="text-align: left;">Clusters</td>
<td style="text-align: left;">Platform-level</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Ansible</strong></td>
<td style="text-align: left;">Day-2 Ops</td>
<td style="text-align: left;">Fleet Management</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Kubernetes orchestration platform </strong></td>
<td style="text-align: left;">Workloads</td>
<td style="text-align: left;">Container Orchestration</td>
</tr>
<tr>
<td style="text-align: left;">---</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h2 id="8-summary-and-next-steps">8. Summary and Next Steps</h2>
<p>This week we evolved from "ClickOps" to <strong>DevOps</strong>. We learned that while GUIs are great for exploration, they do not scale. By using <strong>Cloud-Init</strong> for boot-time logic, <strong>Heat</strong> for infrastructure definition, <strong>Ansible</strong> for configuration, and <strong>Magnum</strong> for container orchestration, we built a repeatable, self-healing cloud environment.</p>
<h3 id="preparing-for-week-12">Preparing for Week 12</h3>
<p>Next week is the <strong>Capstone Project</strong>. You will combine everything you have learned in the last 11 weeks to build a <strong>Production-Ready Cloud Environment</strong>. You will need to provision the network, compute nodes, and storage, and then configure a scalable web service using the automation tools we mastered this week.</p>
<p><strong>Checklist:</strong></p>
<ul>
<li>Can you differentiate between <strong>Imperative</strong> (Bash) and <strong>Declarative</strong> (Heat) automation?</li>
<li>Do you understand why <strong>Idempotency</strong> is critical for Day-2 operations?</li>
<li>Can you explain the transition from Infrastructure-as-Service (Nova platform compute service for VMs ) to Platform-as-Service (Magnum)?</li>
<li>Are you ready to use <strong>Git</strong> to manage your project templates?</li>
</ul>
<hr/>
<h2 id="9-additional-resources">9. Additional Resources</h2>
<p><a href="https://jqplay.org/">jq Playground
<a href="https://cloudinit.readthedocs.io/en/latest/topics/examples.html">Cloud-Init Examples</a></a></p>
<hr/>
<h2 id="10-lab-exercises">10. Lab Exercises</h2>
<p><a href="Week_11_Lab_1_Automation.html">Lab 1: Automation with Scripts
<strong>Goal</strong>: Scripting cloud deployments with Bash, Python, and Heat.</a></p>
<p><a href="Week_11_Lab_2_Ansible.html">Lab 2: Configuration with Ansible
<strong>Goal</strong>: Using Ansible Playbooks to configure a web server fleet.</a></p>
<p><a href="Week_11_Lab_3_Heat.html">Lab 3: heat Infrastructure
<strong>Goal</strong>: Declarative deployment of Network, Security Groups, and Servers.</a></p>
<p><a href="Week_11_Lab_4_Kubernetes.html">Lab 4: Kubernetes with Magnum
<strong>Goal</strong>: Provisioning a K8s cluster and deploying containers.</a></p>
<p><a href="../index.html">← Back to Course Index</a></p>
<div class="mt-12 p-8 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800 text-center">
<h3 class="text-2xl font-bold text-[var(--text-headings)] mb-4">Test Your Knowledge</h3>
<p class="text-[var(--text-body)] mb-6">Ready to check your understanding of this week's material? Take the interactive quiz now!</p>
<a class="inline-block px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors shadow-md no-underline" href="Week_11_Quiz.html" id="start-quiz-btn">
 Start Quiz
 
</a></div>
<div class="chapter-navigation flex justify-between items-center mt-12 pt-8 border-t border-gray-200 dark:border-gray-700">
<a class="flex items-center text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors no-underline" href="../Week 10 - Storage and Persistence/Week_10_Student_Notes.html">
<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path d="M15 19l-7-7 7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
<span>Previous: Week 10: Persistence</span>
</a>
<a class="flex items-center font-semibold text-gray-700 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400 transition-colors no-underline" href="../index.html">
<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
        Course Index
    </a>
<a class="flex items-center text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors no-underline" href="../Week 12 - Final Project and Review/Week_12_Student_Notes.html">
<span>Next: Week 12: Final Review</span>
<svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path d="M9 5l7 7-7 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
</a>
</div></article>
</main>
<!-- Footer -->
<footer class="text-center text-slate-500 dark:text-slate-400 text-sm pb-8">
</footer>
<!-- Progress Tracking -->
<script src="../js/course_logic.js"></script>
</body>
</html>
